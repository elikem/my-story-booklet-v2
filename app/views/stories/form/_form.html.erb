<%= form_with(model: story, id: "story") do |f| %>
  <%= f.hidden_field :user_id, value: current_user.id %>
  <%= f.hidden_field :language, value: "english" %>
  <%= f.hidden_field :status, value: "draft" %>

  <div class="form-group">
    <%= f.text_field :title, class: "form-control text-black font-weight-bold", id: "js-my-story-title", placeholder: "Story title e.g. Susan's Story" %>
  </div>

  <div class="form-group">
    <%= f.text_area :content, class: "form-control", id: "js-my-story-textarea", maxlength: "3000" %>
  </div>
<% end %>

<script type="text/javascript" charset="utf-8">
    tinymce.init({
        selector: '#js-my-story-textarea',
        placeholder: 'Tell your story...',
        paste_as_text: true,
        plugins: "paste",
        paste_data_images: true,
        valid_elements: "p",
        menubar: '',
        toolbar: '',
        allow_conditional_comments: false,
        allow_html_in_named_anchor: false,
        convert_fonts_to_spans : false,

        init_instance_callback: function (editor) {
            editor.on('Change', function (e) {
                displaySaveButton();
            });

            editor.on('keyup', function(e) {
                displaySaveButton();
            });
        }
    });

    function displaySaveButton() {
        var saveButton = $("#js-my-story-save-button");

        if (saveButton.length) {
          saveButton.removeAttr("disabled");
        }
    }

    $("#js-my-story-title").keyup(function() {
        displaySaveButton();
    })
</script>
